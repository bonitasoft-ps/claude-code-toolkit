package com.bonitasoft.processbuilder.document;

/**
 * Corporate branding configuration for all generated documents.
 * All documents MUST use these constants for consistent branding.
 *
 * <p>This class centralizes all visual identity constants used across
 * PDF, HTML, Word, and Excel document generation. Never hardcode
 * color values or font names directly in document services -- always
 * reference these constants instead.</p>
 *
 * <p>Usage example:</p>
 * <pre>
 *     String headerBg = BrandingConfig.PRIMARY_COLOR;  // "#2C3E7A"
 *     String fontName = BrandingConfig.FONT_FAMILY;     // "'Helvetica Neue', Arial, sans-serif"
 * </pre>
 */
public final class BrandingConfig {

    private BrandingConfig() {
        // Prevent instantiation - constants only
    }

    // =========================================================================
    // COLORS
    // =========================================================================

    /** Primary brand color - headers, titles, borders, primary buttons */
    public static final String PRIMARY_COLOR = "#2C3E7A";

    /** Secondary brand color - accents, highlights, links, call-to-action */
    public static final String SECONDARY_COLOR = "#E97826";

    /** Success state color - status indicators, success messages */
    public static final String SUCCESS_COLOR = "#4CAF50";

    /** Warning state color - warnings, attention areas */
    public static final String WARNING_COLOR = "#FF9800";

    /** Error state color - error states, critical alerts */
    public static final String ERROR_COLOR = "#F44336";

    /** Primary text color - body text, paragraphs */
    public static final String TEXT_COLOR = "#333333";

    /** Light text color - secondary text, captions, footnotes */
    public static final String TEXT_LIGHT_COLOR = "#666666";

    /** Background color - page background, card backgrounds */
    public static final String BACKGROUND_COLOR = "#FFFFFF";

    /** Alternate background color - alternating table rows, section backgrounds */
    public static final String BACKGROUND_ALT_COLOR = "#F5F7FA";

    /** Border color - table borders, dividers, separators */
    public static final String BORDER_COLOR = "#E0E0E0";

    // =========================================================================
    // TYPOGRAPHY
    // =========================================================================

    /** Primary font family for all documents */
    public static final String FONT_FAMILY = "'Helvetica Neue', Arial, Helvetica, sans-serif";

    /** Monospace font family for code blocks and technical content */
    public static final String FONT_FAMILY_MONO = "Consolas, Monaco, 'Courier New', monospace";

    /** Title font size in points (for PDF/Word) */
    public static final int FONT_SIZE_TITLE = 24;

    /** Subtitle font size in points */
    public static final int FONT_SIZE_SUBTITLE = 18;

    /** Section heading font size in points */
    public static final int FONT_SIZE_HEADING = 14;

    /** Body text font size in points */
    public static final int FONT_SIZE_BODY = 11;

    /** Small/caption text font size in points */
    public static final int FONT_SIZE_SMALL = 9;

    // =========================================================================
    // LOGO
    // =========================================================================

    /** Path to the Bonitasoft logo in classpath resources */
    public static final String LOGO_RESOURCE_PATH = "/templates/images/bonitasoft-logo.png";

    /** Default logo display width in pixels */
    public static final int LOGO_WIDTH = 150;

    /** Default logo display height in pixels */
    public static final int LOGO_HEIGHT = 40;

    // =========================================================================
    // DOCUMENT STRUCTURE
    // =========================================================================

    /** Company name displayed in documents */
    public static final String COMPANY_NAME = "Bonitasoft";

    /**
     * Footer text template. Use with String.format():
     * {@code String.format(FOOTER_TEXT, "Report Name")}
     * produces: "Generated by Report Name - Bonitasoft"
     */
    public static final String FOOTER_TEXT = "Generated by %s \u2014 Bonitasoft";

    /** Date/time format for document timestamps */
    public static final String DATE_FORMAT = "dd/MM/yyyy HH:mm";

    // =========================================================================
    // PAGE SETUP (in points: 1 inch = 72 points)
    // =========================================================================

    /** Top page margin in points (1 inch) */
    public static final float PAGE_MARGIN_TOP = 72f;

    /** Bottom page margin in points (1 inch) */
    public static final float PAGE_MARGIN_BOTTOM = 72f;

    /** Left page margin in points (0.75 inch) */
    public static final float PAGE_MARGIN_LEFT = 54f;

    /** Right page margin in points (0.75 inch) */
    public static final float PAGE_MARGIN_RIGHT = 54f;

    // =========================================================================
    // HELPER METHODS
    // =========================================================================

    /**
     * Converts a hex color string (e.g., "#2C3E7A") to an RGB byte array.
     * Useful for Apache POI color creation.
     *
     * @param hex Hex color string with or without '#' prefix
     * @return byte array with [red, green, blue] values
     */
    public static byte[] hexToRgb(String hex) {
        hex = hex.replace("#", "");
        return new byte[]{
                (byte) Integer.parseInt(hex.substring(0, 2), 16),
                (byte) Integer.parseInt(hex.substring(2, 4), 16),
                (byte) Integer.parseInt(hex.substring(4, 6), 16)
        };
    }

    /**
     * Returns the hex color string without the '#' prefix.
     * Useful for Apache POI and XWPFRun.setColor() which expects "2C3E7A" format.
     *
     * @param hexColor Hex color string (e.g., "#2C3E7A")
     * @return Color string without '#' (e.g., "2C3E7A")
     */
    public static String colorWithoutHash(String hexColor) {
        return hexColor.replace("#", "");
    }

    /**
     * Returns the first font name from the font family string.
     * Useful for Apache POI which expects a single font name.
     * Example: "'Helvetica Neue', Arial, sans-serif" returns "Helvetica Neue"
     *
     * @param fontFamily CSS font-family string
     * @return First font name, cleaned of quotes
     */
    public static String primaryFontName(String fontFamily) {
        String first = fontFamily.split(",")[0].trim();
        return first.replace("'", "").replace("\"", "");
    }

    /**
     * Convenience: returns the primary font name from FONT_FAMILY.
     *
     * @return Primary font name (e.g., "Helvetica Neue")
     */
    public static String primaryFontName() {
        return primaryFontName(FONT_FAMILY);
    }
}
