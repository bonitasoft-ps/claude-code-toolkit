# Generate Document Service

Scaffold a corporate document generation service following Bonitasoft branding standards.

## Arguments
- `$ARGUMENTS`: Document type and name. Format: `[PDF|HTML|DOCX|XLSX] ServiceName`
  - Example: `PDF InvoiceReport`
  - Example: `HTML KpiDashboard`
  - Example: `DOCX ContractExport`

## Instructions

1. **Parse arguments**: Extract document type (PDF, HTML, DOCX, XLSX) and service name from `$ARGUMENTS`. If no type given, default to PDF.

2. **Check existing infrastructure**:
   - Search for `BrandingConfig.java` in the project
   - Search for `corporate.css` in resources
   - Search for existing document services
   - Check pom.xml for required dependencies

3. **Create BrandingConfig.java** (if it doesn't exist):
   - Create `config/BrandingConfig.java` with all Bonitasoft brand constants:
     - Colors: PRIMARY (`#2C3E7A`), SECONDARY (`#E97826`), SUCCESS, WARNING, ERROR, TEXT, BACKGROUND, BORDER
     - Fonts: FONT_FAMILY (`'Helvetica Neue', Arial, Helvetica, sans-serif`)
     - Logo paths: BONITASOFT_LOGO_PATH, CLIENT_LOGO_KEY
     - Footer template: `"Generated by %s â€” Bonitasoft"`
   - All fields as `public static final String`

4. **Create corporate CSS** (if it doesn't exist):
   - Create `src/main/resources/branding/corporate.css` with CSS variables:
     ```css
     :root {
         --bonita-primary: #2C3E7A;
         --bonita-secondary: #E97826;
         /* ... all brand colors ... */
     }
     ```
   - Include base styles for headers, footers, tables, and typography

5. **Create base HTML template** (if it doesn't exist):
   - Create `src/main/resources/templates/base-layout.html` (Thymeleaf):
     - Header with Bonitasoft logo (left), title (center), optional client logo (right)
     - Footer with project name, generation date, page numbers
     - Link to corporate.css

6. **Create the document service**:

   **For PDF:**
   - Create `AbstractPdfDocumentService.java` with:
     - `generatePdf(DocumentRequest)` method
     - Header/footer rendering using Flying Saucer
     - Thymeleaf template processing
     - Brand color constants from BrandingConfig
   - Create concrete `[ServiceName]PdfService.java` that extends abstract

   **For HTML:**
   - Create `AbstractHtmlDocumentService.java` with:
     - `generateHtml(DocumentRequest)` method
     - Thymeleaf template processing
     - Corporate CSS injection
   - Create concrete `[ServiceName]HtmlService.java`

   **For DOCX:**
   - Create `AbstractDocxDocumentService.java` with:
     - `generateDocx(DocumentRequest)` method
     - Apache POI document setup with corporate fonts/colors
     - Header with logo, footer with page numbers
   - Create concrete `[ServiceName]DocxService.java`

   **For XLSX:**
   - Create `AbstractXlsxDocumentService.java` with:
     - `generateXlsx(DocumentRequest)` method
     - Apache POI workbook with corporate cell styles
     - Branded header row, alternating row colors
   - Create concrete `[ServiceName]XlsxService.java`

7. **Create DocumentRequest DTO** (if it doesn't exist):
   - Java record with: `title`, `subtitle`, `data`, `locale`, `includeClientLogo`

8. **Create Thymeleaf template** for the specific service:
   - `src/main/resources/templates/[service-name]-template.html`
   - Extends base-layout.html
   - Uses corporate CSS variables

9. **Add Maven dependencies** (if not present):
   - For PDF: `com.github.librepdf:openpdf:1.3.30` + `org.xhtmlrenderer:flying-saucer-openpdf:9.1.22`
   - For HTML: `org.thymeleaf:thymeleaf:3.1.2.RELEASE`
   - For DOCX/XLSX: `org.apache.poi:poi-ooxml:5.2.5`

10. **Create unit tests**:
    - Test document generation with sample data
    - Verify header/footer presence
    - Verify brand colors are applied (not hardcoded)
    - Follow naming: `should_generate_pdf_when_valid_request`
    - JUnit 5 + Mockito + AssertJ

11. **Show summary**: List all created files and next steps.

## Output
- List of created/modified files
- Maven dependency snippet (if added)
- Example usage code
- Reminder to add Bonitasoft logo to `src/main/resources/branding/`
